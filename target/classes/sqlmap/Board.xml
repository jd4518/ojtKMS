<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.board">
	
<select id="selectBoardList" parameterType="com.project.util.Pagination" resultType="java.util.HashMap">
	select
		h.*
	from
	(
		select 
			ROWNUM r, t.* 
		from 
		(
			select 
				ROWNUM rn, e.* 
			from 
			(
				select
					b.board_no,
					b.menu_no,
					b.category_no,
					b.board_title,
					b.board_content,
					b.board_complete,
					b.board_regdate,
					b.board_flag,
					b.member_id,
					m.member_name,
					c.category_name
				from
					board b,
					member m,
					category c
				where
					b.member_id = m.member_id
				and
					b.category_no = c.category_no
				and
					b.category_no = #{categoryNo}
			) e order by rn desc
		)t
	)h 
	where r between #{start} and #{end}
</select>

<select id="selectBoardDetail" parameterType="Board" resultType="Board">
	select
			b.board_no			 as boardNo,
			b.menu_no 			 as menuNo,
			b.category_no		 as categoryNo,
			b.board_title 		 as boardTitle,
			b.board_content	 	 as boardContent,
			b.board_complete	 as boardComplete,
			b.board_regdate		 as boardRegDate,
			b.board_flag		 as boardFlag,
			b.member_id			 as memberId,
			m.member_name		 as memberName,
			c.category_name		 as categoryName
	from
			board b,
			member m,
			category c
	where
			b.member_id = m.member_id
	and
			b.category_no = c.category_no
	and
			b.category_no = #{categoryNo}
	and
			b.board_no = #{boardNo}


</select>

<select id="selectBoardCount" parameterType="int" resultType="int">
	select 
		count(*) 
	from 
		board 
	where
		category_no = #{categoryNo}
</select>

<insert id="insertBoard" parameterType="Board">
	insert into board(
			board_no			 ,
			category_no		 	 ,
			menu_no				 ,
			board_title 		 ,
			board_content	 	 ,
			member_id			 
	)
	values
	(
			seq_board_board_no.nextval,
			#{categoryNo, jdbcType=INTEGER},
			#{menuNo, jdbcType=INTEGER},
			#{boardTitle, jdbcType=VARCHAR},
			#{boardContent, jdbcType=VARCHAR},
			#{memberId, jdbcType=VARCHAR}	
	)
</insert>
</mapper>
